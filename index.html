<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StockEasyï½œã‚‰ãã‚‰ãå‚™å“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
  <link href="https://fonts.googleapis.com/css2?family=Kaisei+Tokumin&family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
  font-family: "Noto Sans JP", "Segoe UI", sans-serif;
  margin: 0;
  background: linear-gradient(to bottom right, #f3e8ff, #ede9fe);
}

.sub-heading {
  font-family: 'M PLUS Rounded 1c', sans-serif;
  font-size: 1rem;
  color: #6d6f788f;
  font-weight: 500;
  margin-bottom: 1.5rem;
}
    
    /* ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .hero-section {
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      position: relative;
      overflow: hidden;
    }
    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 30% 50%, rgba(255,255,255,0.1) 0%, transparent 50%);
    }
    .hero-content {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 4rem;
      align-items: center;
      position: relative;
      z-index: 1;
    }
    .hero-text {
      color: white;
    }
    .hero-title {
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      background: linear-gradient(45deg, #fff, #e0e7ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .hero-subtitle {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      opacity: 0.9;
      font-weight: 300;
    }
    .hero-description {
      font-size: 1.1rem;
      opacity: 0.8;
      line-height: 1.8;
    }
    
    /* ãƒ­ã‚°ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ */
    .login-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2.5rem;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .login-card h3 {
      font-size: 1.5rem;
      margin-bottom: 2rem;
      color: #333;
      text-align: center;
      font-weight: 600;
    }
    .role-select {
      width: 100%;
      padding: 1rem;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      font-size: 1rem;
      margin-bottom: 1rem;
      background: white;
      transition: all 0.3s ease;
    }
    .role-select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    .password-area {
      margin-bottom: 1.5rem;
      display: none;
    }
    .password-area input {
      width: 100%;
      padding: 1rem;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    .password-area input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    .login-btn {
      width: 100%;
      padding: 1rem 2rem;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }
    
    /* æ©Ÿèƒ½ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .features-section {
      padding: 6rem 0;
      background: white;
    }
    .section-title {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 3rem;
      color: #333;
      font-weight: 700;
    }
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
    }
    .feature-card {
      text-align: center;
      padding: 2.5rem 1.5rem;
      background: #f8fafc;
      border-radius: 16px;
      transition: all 0.3s ease;
      border: 1px solid #e2e8f0;
    }
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      background: white;
    }
    .feature-icon {
      font-size: 3rem;
      margin-bottom: 1.5rem;
    }
    .feature-card h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: #333;
      font-weight: 600;
    }
    .feature-card p {
      color: #666;
      line-height: 1.6;
    }
    
    /* åˆ©ç”¨è€…åˆ¥æ©Ÿèƒ½ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .roles-section {
      padding: 6rem 0;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
    }
    .roles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 3rem;
    }
    .role-card {
      background: white;
      padding: 3rem;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    .role-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    }
    .role-card h3 {
      font-size: 1.5rem;
      margin-bottom: 2rem;
      font-weight: 600;
    }
    .staff-card h3 {
      color: #10b981;
    }
    .admin-card h3 {
      color: #8b5cf6;
    }
    .role-card ul {
      list-style: none;
    }
    .role-card li {
      padding: 0.8rem 0;
      border-bottom: 1px solid #f1f5f9;
      position: relative;
      padding-left: 2rem;
    }
    .role-card li:before {
      content: 'âœ“';
      position: absolute;
      left: 0;
      color: #10b981;
      font-weight: bold;
    }
    .admin-card li:before {
      color: #8b5cf6;
    }
    
    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
    @media (max-width: 768px) {
      .hero-content {
        grid-template-columns: 1fr;
        gap: 2rem;
        text-align: center;
      }
      .hero-title {
        font-size: 2.5rem;
      }
      .login-card {
        padding: 2rem;
      }
      .roles-grid {
        grid-template-columns: 1fr;
      }
      .container {
        padding: 0 1rem;
      }
    }
    
    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
    .main-content {
      margin: 1rem;
    }
    h1 {
      font-size: 1.8rem;
      color: #4CAF50;
    }
    button {
      margin: 0.2rem;
      padding: 0.4rem 0.8rem;
      border: none;
      border-radius: 6px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #45a049;
    }
    .delete-button {
      background-color: #f44336;
    }
    .delete-button:hover {
      background-color: #d32f2f;
    }
    input, select {
      padding: 0.4rem;
      margin: 0.2rem;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #eee;
      padding: 0.6rem;
      text-align: left;
    }
    th {
      background: #e8f5e9;
      color: #2e7d32;
    }
    .image-preview {
      width: 100px;
      height: auto;
      object-fit: contain;
      border: 1px solid #ccc;
      border-radius: 8px;
      transition: transform 0.2s;
    }
    .image-wrapper {
      position: relative;
      display: inline-block;
    }
    .edit-button {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      padding: 0.2rem 0.4rem;
      font-size: 0.8rem;
      display: none;
      cursor: pointer;
    }
    .image-wrapper:hover .edit-button {
      display: block;
    }
    .modal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }
    .modal-content {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      width: 300px;
    }
    .edit-modal-content {
      background: white;
      padding: 2rem;
      border-radius: 8px;
      width: 400px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .form-group {
      margin-bottom: 1rem;
    }
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: #333;
    }
    .form-group input, .form-group select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .storage-notice {
      background: linear-gradient(45deg, #e3f2fd, #f3e5f5);
      border: 1px solid #2196f3;
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1.5rem;
      color: #1976d2;
      font-size: 0.9rem;
      text-align: center;
    }
    .button-group {
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
      margin-top: 1.5rem;
    }
  </style>
</head>
<body>
  <!-- ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ -->
  <div id="loginArea" style="display: block;">
    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section class="hero-section">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">StockEasy</h1>
          <p class="hero-subtitle">æ–½è¨­å‚™å“ã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã™ã‚‹ã‚¹ãƒãƒ¼ãƒˆãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</p>
          <p class="hero-description">
            å‚™å“ã®è²¸å‡ºãƒ»è¿”å´ã‹ã‚‰åœ¨åº«ç®¡ç†ã¾ã§ã€ã™ã¹ã¦ã‚’ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã€‚<br>
            ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œã§ã€æ–½è¨­é‹å–¶ã‚’ã‚‚ã£ã¨ã‚¹ãƒ ãƒ¼ã‚ºã«ã€‚
          </p>
        </div>
        <div class="login-card">
          <h3>ã‚·ã‚¹ãƒ†ãƒ ã«ãƒ­ã‚°ã‚¤ãƒ³</h3>
          <select id="roleSelect" class="role-select">
            <option value="staff">è·å“¡ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³</option>
            <option value="admin">ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³</option>
          </select>
          <div id="passwordArea" class="password-area">
            <input type="password" id="adminPassword" placeholder="ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" />
          </div>
          <button onclick="login()" class="login-btn">ãƒ­ã‚°ã‚¤ãƒ³</button>
          <div class="storage-notice">
            <strong>Ver.2.01</strong> - ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯localStorageã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–ã—ã¾ã™ã€‚
          </div>
        </div>
      </div>
    </section>

    <!-- æ©Ÿèƒ½ç´¹ä»‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section class="features-section">
      <div class="container">
        <h2 class="section-title">ä¸»ãªæ©Ÿèƒ½</h2>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">ğŸ“‹</div>
            <h3>å‚™å“ç™»éŒ²ãƒ»ç®¡ç†</h3>
            <p>è»Šã„ã™ã€æ­©è¡Œå™¨ã€ã‚¨ã‚¢ãƒãƒƒãƒˆãªã©æ§˜ã€…ãªå‚™å“ã‚’å†™çœŸä»˜ãã§ç™»éŒ²ãƒ»ç®¡ç†ã§ãã¾ã™ã€‚</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">ğŸ”„</div>
            <h3>è²¸å‡ºãƒ»è¿”å´ç®¡ç†</h3>
            <p>å‚™å“ã®è²¸å‡ºçŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æŠŠæ¡ã€‚æ¨å¥¨è¿”å´å ´æ‰€ã®è¡¨ç¤ºã§åŠ¹ç‡çš„ãªé‹ç”¨ã‚’å®Ÿç¾ã€‚</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">ğŸ“</div>
            <h3>å ´æ‰€ãƒ»çŠ¶æ…‹è¿½è·¡</h3>
            <p>å„å‚™å“ã®ç¾åœ¨åœ°ã€ä½¿ç”¨çŠ¶æ³ã€å‚™è€ƒæƒ…å ±ã‚’ä¸€ç›®ã§ç¢ºèªã€‚ç´›å¤±é˜²æ­¢ã«ã‚‚åŠ¹æœçš„ã€‚</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">ğŸ“Š</div>
            <h3>ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
            <p>å‚™å“ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã§ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚„ä»–ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºã‚‚ç°¡å˜ã€‚</p>
          </div>
        </div>
      </div>
    </section>

    <!-- åˆ©ç”¨è€…åˆ¥æ©Ÿèƒ½ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <section class="roles-section">
      <div class="container">
        <h2 class="section-title">åˆ©ç”¨è€…åˆ¥æ©Ÿèƒ½</h2>
        <div class="roles-grid">
          <div class="role-card staff-card">
            <h3>ğŸ‘¥ è·å“¡å‘ã‘æ©Ÿèƒ½</h3>
            <ul>
              <li>å‚™å“ã®è²¸å‡ºãƒ»è¿”å´æ“ä½œ</li>
              <li>å‚™å“çŠ¶æ³ã®ç¢ºèª</li>
              <li>å‚™è€ƒæƒ…å ±ã®è¿½åŠ ãƒ»ç·¨é›†</li>
              <li>ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</li>
            </ul>
          </div>
          <div class="role-card admin-card">
            <h3>âš™ï¸ ç®¡ç†è€…å‘ã‘æ©Ÿèƒ½</h3>
            <ul>
              <li>æ–°è¦å‚™å“ã®ç™»éŒ²</li>
              <li>å‚™å“æƒ…å ±ã®ç·¨é›†ãƒ»å‰Šé™¤</li>
              <li>å‚™å“ç”»åƒã®ç®¡ç†</li>
              <li>ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div id="mainContent" class="main-content" style="display: none;">
    <h1>StockEasy</h1>
    <p class="sub-heading">ã‚‰ãã‚‰ãå‚™å“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </p>
    <div style="margin-bottom: 1rem; display: flex; align-items: center;">
      <select id="categoryFilter" onchange="filterItems()" style="margin-right: 1rem;">
        <option value="">å…¨ã¦</option>
        <option value="è»Šã„ã™">è»Šã„ã™</option>
        <option value="æ­©è¡Œå™¨ãƒ»ã‚·ãƒ«ãƒãƒ¼ã‚«ãƒ¼">æ­©è¡Œå™¨ãƒ»ã‚·ãƒ«ãƒãƒ¼ã‚«ãƒ¼</option>
        <option value="ã‚¨ã‚¢ãƒãƒƒãƒˆ">ã‚¨ã‚¢ãƒãƒƒãƒˆ</option>
        <option value="ãã®ä»–">ãã®ä»–</option>
      </select>
      <button onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      <button onclick="exportData()" style="margin-left: 1rem;">ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
      <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData()" />
      <button onclick="document.getElementById('importFile').click()" style="margin-left: 0.5rem;">ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
    </div>

    <div id="adminArea" style="display: none">
      <h2>æ–°è¦ç™»éŒ²ï¼ˆç®¡ç†è€…ï¼‰</h2>
      <input type="text" id="itemName" placeholder="å‚™å“å" />
      <input type="text" id="itemId" placeholder="ID" />
      <select id="itemLocation">
        <option value="äº‹å‹™æ‰€">äº‹å‹™æ‰€</option>
        <option value="1F">1F</option>
        <option value="2F">2F</option>
        <option value="3F">3F</option>
        <option value="4F">4F</option>
        <option value="5F">5F</option>
        <option value="åœ°åŸŸäº¤æµå®¤">åœ°åŸŸäº¤æµå®¤</option>
        <option value="æ©Ÿèƒ½è¨“ç·´å®¤">æ©Ÿèƒ½è¨“ç·´å®¤</option>
      </select>
      <select id="itemCategory">
        <option value="è»Šã„ã™">è»Šã„ã™</option>
        <option value="æ­©è¡Œå™¨ãƒ»ã‚·ãƒ«ãƒãƒ¼ã‚«ãƒ¼">æ­©è¡Œå™¨ãƒ»ã‚·ãƒ«ãƒãƒ¼ã‚«ãƒ¼</option>
        <option value="ã‚¨ã‚¢ãƒãƒƒãƒˆ">ã‚¨ã‚¢ãƒãƒƒãƒˆ</option>
        <option value="ãã®ä»–">ãã®ä»–</option>
      </select>
      <input type="file" id="itemImage" accept="image/*" />
      <button onclick="registerItem()">ç™»éŒ²</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>ç”»åƒ</th>
          <th>å‚™å“å</th>
          <th>ID</th>
          <th>ä¿ç®¡å ´æ‰€</th>
          <th>ç¾åœ¨åœ°</th>
          <th>ä½¿ç”¨è€…</th>
          <th>çŠ¶æ…‹</th>
          <th>å‚™è€ƒ</th>
          <th>ç¨®åˆ¥</th>
          <th>æ“ä½œ</th>
        </tr>
      </thead>
      <tbody id="itemTable"></tbody>
    </table>

    <div class="modal" id="borrowModal">
      <div class="modal-content">
        <h3>å€Ÿç”¨å…ˆã‚’é¸æŠ</h3>
        <select id="borrowSelect">
          <option>äº‹å‹™æ‰€</option>
          <option>1F</option>
          <option>2F</option>
          <option>3F</option>
          <option>4F</option>
          <option>5F</option>
          <option>åœ°åŸŸäº¤æµå®¤</option>
          <option>æ©Ÿèƒ½è¨“ç·´å®¤</option>
        </select>
        <button onclick="confirmBorrow()">æ±ºå®š</button>
        <button onclick="closeBorrowModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>
    </div>

    <div class="modal" id="returnModal">
      <div class="modal-content">
        <h3>è¿”å´å ´æ‰€ã‚’é¸æŠ</h3>
        <p id="suggestedReturn"></p>
        <select id="returnSelect">
          <option>äº‹å‹™æ‰€</option>
          <option>1F</option>
          <option>2F</option>
          <option>3F</option>
          <option>4F</option>
          <option>5F</option>
          <option>åœ°åŸŸäº¤æµå®¤</option>
          <option>æ©Ÿèƒ½è¨“ç·´å®¤</option>
        </select>
        <button onclick="confirmReturn()">æ±ºå®š</button>
        <button onclick="closeReturnModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>
    </div>

    <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal" id="editModal">
      <div class="edit-modal-content">
        <h3>å‚™å“æƒ…å ±ç·¨é›†</h3>
        <div class="form-group">
          <label for="editItemName">å‚™å“å</label>
          <input type="text" id="editItemName" />
        </div>
        <div class="form-group">
          <label for="editItemId">ID</label>
          <input type="text" id="editItemId" />
        </div>
        <div class="form-group">
          <label for="editItemLocation">ä¿ç®¡å ´æ‰€</label>
          <select id="editItemLocation">
            <option value="äº‹å‹™æ‰€">äº‹å‹™æ‰€</option>
            <option value="1F">1F</option>
            <option value="2F">2F</option>
            <option value="3F">3F</option>
            <option value="4F">4F</option>
            <option value="5F">5F</option>
            <option value="åœ°åŸŸäº¤æµå®¤">åœ°åŸŸäº¤æµå®¤</option>
            <option value="æ©Ÿèƒ½è¨“ç·´å®¤">æ©Ÿèƒ½è¨“ç·´å®¤</option>
          </select>
        </div>
        <div class="form-group">
          <label for="editItemCategory">ç¨®åˆ¥</label>
          <select id="editItemCategory">
            <option value="è»Šã„ã™">è»Šã„ã™</option>
            <option value="æ­©è¡Œå™¨ãƒ»ã‚·ãƒ«ãƒãƒ¼ã‚«ãƒ¼">æ­©è¡Œå™¨ãƒ»ã‚·ãƒ«ãƒãƒ¼ã‚«ãƒ¼</option>
            <option value="ã‚¨ã‚¢ãƒãƒƒãƒˆ">ã‚¨ã‚¢ãƒãƒƒãƒˆ</option>
            <option value="ãã®ä»–">ãã®ä»–</option>
          </select>
        </div>
        <div class="button-group">
          <button onclick="confirmEdit()">ä¿å­˜</button>
          <button onclick="closeEditModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button class="delete-button" onclick="confirmDelete()">å‰Šé™¤</button>
        </div>
      </div>
    </div>

    <input type="file" id="editImageInput" accept="image/*" style="display:none" />
  </div>

  <script>
    let items = [];
    let currentIndex = null;
    let isAdmin = false;
    let editingIndex = null;

    // ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã¨èª­ã¿è¾¼ã¿
    function saveItems() {
      try {
        localStorage.setItem('equipmentItems', JSON.stringify(items));
        console.log('ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
      } catch (error) {
        console.error('ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
        alert('ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å®¹é‡ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
      }
    }

    function loadItems() {
      try {
        const savedItems = localStorage.getItem('equipmentItems');
        if (savedItems) {
          items = JSON.parse(savedItems);
          console.log('ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
        }
      } catch (error) {
        console.error('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
        items = [];
      }
    }

    // ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½
    function exportData() {
      const dataStr = JSON.stringify(items, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'equipment_data.json';
      link.click();
      URL.revokeObjectURL(url);
    }

    function importData() {
      const file = document.getElementById('importFile').files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const importedData = JSON.parse(e.target.result);
          if (confirm('ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç½®ãæ›ãˆã¾ã™ã‹ï¼Ÿ')) {
            items = importedData;
            saveItems();
            renderItems();
            alert('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
          }
        } catch (error) {
          alert('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      };
      reader.readAsText(file);
    }

    function renderItems() {
      const tbody = document.getElementById('itemTable');
      tbody.innerHTML = '';
      items.forEach((item, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>
            <div class="image-wrapper">
              <img src="${item.image || ''}" class="image-preview" onerror="this.style.display='none'" />
              ${isAdmin ? `<button class="edit-button" onclick="editImage(${index})">ç·¨é›†</button>` : ''}
            </div>
          </td>
          <td>${item.name}</td>
          <td>${item.id}</td>
          <td>${item.location}</td>
          <td>${item.current || ''}</td>
          <td>${item.user || ''}</td>
          <td>
            <span style="color: ${item.status === 'å¾…æ©Ÿ' ? '#4CAF50' : '#f44336'};">
              ${item.status}
            </span>
          </td>
          <td><input type="text" value="${item.note || ''}" onchange="items[${index}].note=this.value; saveItems();" /></td>
          <td>${item.category}</td>
          <td>
            <button onclick="openBorrow(${index})">å€Ÿç”¨</button>
            <button onclick="openReturn(${index})">è¿”å´</button>
            ${isAdmin ? `<button onclick="openEdit(${index})">ç·¨é›†</button>` : ''}
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function registerItem() {
      const name = document.getElementById('itemName').value;
      const id = document.getElementById('itemId').value;
      const location = document.getElementById('itemLocation').value;
      const category = document.getElementById('itemCategory').value;
      const imageFile = document.getElementById('itemImage').files[0];

      if (!name || !id || !location) {
        alert('å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      // é‡è¤‡IDãƒã‚§ãƒƒã‚¯
      if (items.some(item => item.id === id)) {
        alert('ã“ã®IDã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™');
        return;
      }

      const item = {
        name: name,
        id: id,
        location: location,
        category: category,
        current: '',
        user: '',
        status: 'å¾…æ©Ÿ',
        note: '',
        history: [],
        createdAt: new Date().toISOString()
      };

      if (imageFile) {
        const reader = new FileReader();
        reader.onload = () => {
          item.image = reader.result;
          items.push(item);
          saveItems();
          renderItems();
          clearForm();
        };
        reader.readAsDataURL(imageFile);
      } else {
        items.push(item);
        saveItems();
        renderItems();
        clearForm();
      }
    }

    function clearForm() {
      document.getElementById('itemName').value = '';
      document.getElementById('itemId').value = '';
      document.getElementById('itemLocation').value = 'äº‹å‹™æ‰€';
      document.getElementById('itemCategory').value = 'è»Šã„ã™';
      document.getElementById('itemImage').value = '';
    }

    function editImage(index) {
      const input = document.getElementById('editImageInput');
      input.onchange = () => {
        const file = input.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = () => {
            items[index].image = reader.result;
            saveItems();
            renderItems();
          };
          reader.readAsDataURL(file);
        } else {
          delete items[index].image;
          saveItems();
          renderItems();
        }
      };
      input.click();
    }

    // ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£ã®é–¢æ•°
    function openEdit(index) {
      editingIndex = index;
      const item = items[index];
      
      document.getElementById('editItemName').value = item.name;
      document.getElementById('editItemId').value = item.id;
      document.getElementById('editItemLocation').value = item.location;
      document.getElementById('editItemCategory').value = item.category;
      
      document.getElementById('editModal').style.display = 'flex';
    }

    function closeEditModal() {
      document.getElementById('editModal').style.display = 'none';
      editingIndex = null;
    }

    function confirmEdit() {
      if (editingIndex === null) return;
      
      const name = document.getElementById('editItemName').value;
      const id = document.getElementById('editItemId').value;
      const location = document.getElementById('editItemLocation').value;
      const category = document.getElementById('editItemCategory').value;

      if (!name || !id || !location) {
        alert('å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      // é‡è¤‡IDãƒã‚§ãƒƒã‚¯ï¼ˆè‡ªåˆ†ä»¥å¤–ï¼‰
      if (items.some((item, index) => item.id === id && index !== editingIndex)) {
        alert('ã“ã®IDã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™');
        return;
      }

      // æ›´æ–°å‡¦ç†
      items[editingIndex].name = name;
      items[editingIndex].id = id;
      items[editingIndex].location = location;
      items[editingIndex].category = category;

      saveItems();
      renderItems();
      closeEditModal();
      alert('å‚™å“æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
    }

    function confirmDelete() {
      if (editingIndex === null) return;
      
      if (confirm(`å‚™å“ã€Œ${items[editingIndex].name}ã€ã‚’æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        items.splice(editingIndex, 1);
        saveItems();
        renderItems();
        closeEditModal();
        alert('å‚™å“ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
      }
    }

    function openBorrow(index) {
      currentIndex = index;
      document.getElementById('borrowModal').style.display = 'flex';
    }

    function closeBorrowModal() {
      document.getElementById('borrowModal').style.display = 'none';
    }

    function confirmBorrow() {
      const place = document.getElementById('borrowSelect').value;
      const timestamp = new Date().toLocaleString('ja-JP');
      
      items[currentIndex].user = place;
      items[currentIndex].current = place;
      items[currentIndex].status = 'ä½¿ç”¨ä¸­';
      items[currentIndex].history = items[currentIndex].history || [];
      items[currentIndex].history.push({ 
        action: 'å€Ÿç”¨', 
        place: place, 
        timestamp: timestamp 
      });
      
      saveItems();
      renderItems();
      closeBorrowModal();
    }

    function openReturn(index) {
      currentIndex = index;
      const location = items[index].location;
      document.getElementById('suggestedReturn').textContent = `æ¨å¥¨è¿”å´å ´æ‰€ï¼š${location}`;
      document.getElementById('returnModal').style.display = 'flex';
    }

    function closeReturnModal() {
      document.getElementById('returnModal').style.display = 'none';
    }

    function confirmReturn() {
      const place = document.getElementById('returnSelect').value;
      const timestamp = new Date().toLocaleString('ja-JP');
      
      items[currentIndex].user = '';
      items[currentIndex].current = place;
      items[currentIndex].status = 'å¾…æ©Ÿ';
      items[currentIndex].history = items[currentIndex].history || [];
      items[currentIndex].history.push({ 
        action: 'è¿”å´', 
        place: place, 
        timestamp: timestamp 
      });
      
      saveItems();
      renderItems();
      closeReturnModal();
    }

    function login() {
      const role = document.getElementById('roleSelect').value;
      const password = document.getElementById('adminPassword').value;
      
      if (role === 'admin') {
        if (password !== 'admin123') {
          alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™');
          return;
        }
      }
      
      document.getElementById('loginArea').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
      isAdmin = role === 'admin';
      document.getElementById('adminArea').style.display = isAdmin ? 'block' : 'none';
      loadItems();
      renderItems();
    }

    function logout() {
      document.getElementById('loginArea').style.display = 'block';
      document.getElementById('mainContent').style.display = 'none';
      isAdmin = false;
      document.getElementById('adminArea').style.display = 'none';
      document.getElementById('roleSelect').value = 'staff';
      document.getElementById('passwordArea').style.display = 'none';
      document.getElementById('adminPassword').value = '';
    }

    function filterItems() {
      const category = document.getElementById('categoryFilter').value;
      const tbody = document.getElementById('itemTable');
      tbody.innerHTML = '';
      items.forEach((item, index) => {
        if (!category || item.category === category) {
          renderTableRow(item, index);
        }
      });
    }

    function renderTableRow(item, index) {
      const tbody = document.getElementById('itemTable');
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>
          <div class="image-wrapper">
            <img src="${item.image || ''}" class="image-preview" onerror="this.style.display='none'" />
            ${isAdmin ? `<button class="edit-button" onclick="editImage(${index})">ç·¨é›†</button>` : ''}
          </div>
        </td>
        <td>${item.name}</td>
        <td>${item.id}</td>
        <td>${item.location}</td>
        <td>${item.current || ''}</td>
        <td>${item.user || ''}</td>
        <td>
          <span style="color: ${item.status === 'å¾…æ©Ÿ' ? '#4CAF50' : '#f44336'};">
            ${item.status}
          </span>
        </td>
        <td><input type="text" value="${item.note || ''}" onchange="items[${index}].note=this.value; saveItems();" /></td>
        <td>${item.category}</td>
        <td>
          <button onclick="openBorrow(${index})">å€Ÿç”¨</button>
          <button onclick="openReturn(${index})">è¿”å´</button>
          ${isAdmin ? `<button onclick="openEdit(${index})">ç·¨é›†</button>` : ''}
        </td>
      `;
      tbody.appendChild(tr);
    }

    // åˆæœŸåŒ–å‡¦ç†
    document.addEventListener('DOMContentLoaded', function() {
      // åˆæœŸçŠ¶æ…‹ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¬„ã‚’éè¡¨ç¤ºã«ã™ã‚‹
      document.getElementById('passwordArea').style.display = 'none';
      
      document.getElementById('roleSelect').addEventListener('change', function() {
        const passwordArea = document.getElementById('passwordArea');
        if (this.value === 'admin') {
          passwordArea.style.display = 'block';
          document.getElementById('adminPassword').placeholder = 'ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰';
        } else {
          passwordArea.style.display = 'none';
          document.getElementById('adminPassword').value = '';
        }
      });
    });

    // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã«é–‰ã˜ã‚‹
    document.addEventListener('click', function(e) {
      if (e.target.classList.contains('modal')) {
        e.target.style.display = 'none';
      }
    });
  </script>
</body>
</html>
